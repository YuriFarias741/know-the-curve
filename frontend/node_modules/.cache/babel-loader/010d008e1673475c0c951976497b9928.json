{"ast":null,"code":"import _objectSpread from\"/home/lifeapp/pessoal/know-the-curve-web/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"/home/lifeapp/pessoal/know-the-curve-web/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/lifeapp/pessoal/know-the-curve-web/node_modules/@babel/runtime/helpers/esm/createClass\";import _createSuper from\"/home/lifeapp/pessoal/know-the-curve-web/node_modules/@babel/runtime/helpers/esm/createSuper\";import _inherits from\"/home/lifeapp/pessoal/know-the-curve-web/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from'react';import{Map,Polygon,GoogleApiWrapper,Marker}from'google-maps-react';import'../assets/form.css';import'./mapa.css';import*as _ from'lodash';import polygonsJson from'../assets/polygons.json';import pSBC from'../utils/pscb';import{fetchCoutryResources}from'../services/api';import LatLonJson from'../assets/latlon.json';export var MapContainer=/*#__PURE__*/function(_Component){_inherits(MapContainer,_Component);var _super=_createSuper(MapContainer);function MapContainer(props){var _this;_classCallCheck(this,MapContainer);_this=_super.call(this,props);_this.showDetails=function(state){};_this.renderPolygons=function(){return _this.state.states.map(function(state){return/*#__PURE__*/React.createElement(Polygon,{key:'Polygon'+state.sigla,path:state.coordinates,strokeColor:'#ccc',fillColor:pSBC(0.01*(_.get(state,'data.slope',0)/100),'rgb(255,255,255)','rgb(225, 44, 61)'),strokeWeight:1,fillOpacity:0.7,onClick:function onClick(){return _this.showDetails(state);}});});};_this.rendermarker=function(){return _this.state.states.map(function(state){console.log(state.geo);return/*#__PURE__*/React.createElement(Marker,{key:'Marker'+state.sigla,position:state.geo,name:state.sigla});});};_this.state={states:[],loadingMap:true,loadingChart:true,chart:''};return _this;}_createClass(MapContainer,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;var polygonsNomalized=Object.keys(polygonsJson).map(function(key){return{id:key,sigla:key,coordinates:_.get(polygonsJson,key).filter(function(i){return i.length>0;}).map(function(geo){return{lat:geo[1],lng:geo[0]};})};});fetchCoutryResources('brazil').then(function(data){_this2.setState({loadingMap:false,states:polygonsNomalized.map(function(state){var resources=_.find(data,{state:state.sigla});var geo=_.get(LatLonJson,state.sigla);return _objectSpread({},state,{geo:{lat:_.get(geo,'lat'),lng:_.get(geo,'lon')},data:{cases:_.get(resources,'data.cases',0),slope:_.get(resources,'data.slope',0)}});})});}).catch(function(err){_this2.setState({loadingMap:false});console.log(err);});fetch(\"http://localhost:8000/api/brazil/demographic_density\").then(function(response){return response.text();}).then(function(data){_this2.setState(_objectSpread({},_this2.state,{loadingChart:false,chart:data}));}).catch(function(err){_this2.setState(_objectSpread({},_this2.state,{loadingChart:false}));console.log(err);});}},{key:\"render\",value:function render(){var containerStyle={position:'relative',width:'100%',height:'100%'};// handlerChangeState = (event) => {};\nreturn/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"container-fluid content content\",id:\"maps\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-3 col-sm-12 col-sm-12 mapa-info\"},/*#__PURE__*/React.createElement(\"h2\",null,\"Mapa de propaga\\xE7\\xE3o\"),/*#__PURE__*/React.createElement(\"p\",null,\"O mapa ao lado traz, em um primeiro momento, um panorama dos casos de covid-19 no Brasil. Por se tratar de um mapa de calor, a intensidade de suas cores \\xE9 determinada com base no alto \\xEDndice de propaga\\xE7\\xE3o do coronav\\xEDrus em cada regi\\xE3o. Al\\xE9m disso, o mapa permite analisar a situa\\xE7\\xE3o em cada estado do pa\\xEDs, de forma mais detalhada. Ao selecionar o estado que se \\u201Cdeseja\\u201D, o crescimento da doen\\xE7a no local ser\\xE1 representado por meio de um gr\\xE1fico. Este, por sua vez, corresponde \\xE0 curva da doen\\xE7a para aquele estado.\")),/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-9 col-sm-12\"},/*#__PURE__*/React.createElement(\"div\",{className:\"mapa\"},/*#__PURE__*/React.createElement(Map,{google:this.props.google,containerStyle:containerStyle,initialCenter:{lat:-17.17999531784841,lng:-57.23911032110355},onCenterChanged:function onCenterChanged(m,p,e){console.log(p.center.lat(),p.center.lng());},zoom:4},this.renderPolygons()),this.state.loadingMap&&/*#__PURE__*/React.createElement(\"div\",{className:\"loading\"},/*#__PURE__*/React.createElement(\"i\",{className:\"fas fa-circle-notch fa-spin\"}),\"Carregando dados...\"))))),/*#__PURE__*/React.createElement(\"div\",{className:\"container-fluid content charts\",id:\"chart\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-9 col-sm-12\"},/*#__PURE__*/React.createElement(\"iframe\",{className:\"chartFrame\",srcDoc:this.state.chart}),this.state.loadingChart&&/*#__PURE__*/React.createElement(\"div\",{className:\"loading\"},/*#__PURE__*/React.createElement(\"i\",{className:\"fas fa-circle-notch fa-spin\"}),\"Carregando dados...\")),/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-3 col-sm-12 mapa-info\"},/*#__PURE__*/React.createElement(\"h2\",null,\"Densidade demogr\\xE1fica\"),/*#__PURE__*/React.createElement(\"p\",null,\"O gr\\xE1fico ao lado traz uma correla\\xE7\\xE3o de densidade demogr\\xE1fica com casos confirmados de covid-19.\")))));}}]);return MapContainer;}(Component);export default GoogleApiWrapper({apiKey:'AIzaSyA4FiGeCZpUpO663wOfg-23qpr1-bLPZU4'})(MapContainer);","map":{"version":3,"sources":["/home/lifeapp/pessoal/know-the-curve-web/src/pages/home.jsx"],"names":["React","Component","Map","Polygon","GoogleApiWrapper","Marker","_","polygonsJson","pSBC","fetchCoutryResources","LatLonJson","MapContainer","props","showDetails","state","renderPolygons","states","map","sigla","coordinates","get","rendermarker","console","log","geo","loadingMap","loadingChart","chart","polygonsNomalized","Object","keys","key","id","filter","i","length","lat","lng","then","data","setState","resources","find","cases","slope","catch","err","fetch","response","text","containerStyle","position","width","height","google","m","p","e","center","apiKey"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\nimport {Map, Polygon, GoogleApiWrapper, Marker} from 'google-maps-react';\nimport '../assets/form.css';\nimport './mapa.css';\nimport * as _ from 'lodash';\nimport polygonsJson from '../assets/polygons.json';\nimport pSBC from '../utils/pscb';\nimport {fetchCoutryResources} from '../services/api';\nimport LatLonJson from '../assets/latlon.json';\n\nexport class MapContainer extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      states: [],\n      loadingMap: true,\n      loadingChart: true,\n      chart: '',\n    };\n  }\n\n  componentDidMount() {\n    let polygonsNomalized = Object.keys(polygonsJson).map(key => {\n      return {\n        id: key,\n        sigla: key,\n        coordinates: _.get(polygonsJson, key)\n          .filter(i => i.length > 0)\n          .map(geo => ({\n            lat: geo[1],\n            lng: geo[0],\n          })),\n      };\n    });\n    fetchCoutryResources('brazil')\n      .then(data => {\n        this.setState({\n          loadingMap: false,\n          states: polygonsNomalized.map(state => {\n            const resources = _.find(data, {state: state.sigla});\n            const geo = _.get(LatLonJson, state.sigla);\n            return {\n              ...state,\n              geo: {\n                lat: _.get(geo, 'lat'),\n                lng: _.get(geo, 'lon'),\n              },\n              data: {\n                cases: _.get(resources, 'data.cases', 0),\n                slope: _.get(resources, 'data.slope', 0),\n              },\n            };\n          }),\n        });\n      })\n      .catch(err => {\n        this.setState({\n          loadingMap: false,\n        });\n        console.log(err);\n      });\n    fetch(`http://localhost:8000/api/brazil/demographic_density`)\n      .then(response => response.text())\n      .then(data => {\n        this.setState({\n          ...this.state,\n          loadingChart: false,\n          chart: data,\n        });\n      })\n      .catch(err => {\n        this.setState({...this.state, loadingChart: false});\n        console.log(err);\n      });\n  }\n  showDetails = state => {};\n  renderPolygons = () => {\n    return this.state.states.map(state => {\n      return (\n        <Polygon\n          key={'Polygon' + state.sigla}\n          path={state.coordinates}\n          strokeColor={'#ccc'}\n          fillColor={pSBC(\n            0.01 * (_.get(state, 'data.slope', 0) / 100),\n            'rgb(255,255,255)',\n            'rgb(225, 44, 61)'\n          )}\n          strokeWeight={1}\n          fillOpacity={0.7}\n          onClick={() => this.showDetails(state)}\n        />\n      );\n    });\n  };\n  rendermarker = () => {\n    return this.state.states.map(state => {\n      console.log(state.geo);\n      return (\n        <Marker\n          key={'Marker' + state.sigla}\n          position={state.geo}\n          name={state.sigla}\n        />\n      );\n    });\n  };\n  render() {\n    const containerStyle = {\n      position: 'relative',\n      width: '100%',\n      height: '100%',\n    };\n\n    // handlerChangeState = (event) => {};\n    return (\n      <>\n        <div className=\"container-fluid content content\" id=\"maps\">\n          <div className=\"row\">\n            <div className=\"col-md-3 col-sm-12 col-sm-12 mapa-info\">\n              <h2>Mapa de propagação</h2>\n              <p>\n                O mapa ao lado traz, em um primeiro momento, um panorama dos\n                casos de covid-19 no Brasil. Por se tratar de um mapa de calor,\n                a intensidade de suas cores é determinada com base no alto\n                índice de propagação do coronavírus em cada região. Além disso,\n                o mapa permite analisar a situação em cada estado do país, de\n                forma mais detalhada. Ao selecionar o estado que se “deseja”, o\n                crescimento da doença no local será representado por meio de um\n                gráfico. Este, por sua vez, corresponde à curva da doença para\n                aquele estado.\n              </p>\n            </div>\n            <div className=\"col-md-9 col-sm-12\">\n              <div className=\"mapa\">\n                <Map\n                  google={this.props.google}\n                  containerStyle={containerStyle}\n                  initialCenter={{\n                    lat: -17.17999531784841,\n                    lng: -57.23911032110355,\n                  }}\n                  onCenterChanged={(m, p, e) => {\n                    console.log(p.center.lat(),p.center.lng())\n                  }}\n                  zoom={4}\n                >\n                  {this.renderPolygons()}\n                  {/* {this.rendermarker()} */}\n                </Map>\n                {this.state.loadingMap && (\n                  <div className=\"loading\">\n                    <i className=\"fas fa-circle-notch fa-spin\"></i>\n                    Carregando dados...\n                  </div>\n                )}\n              </div>\n            </div>\n          </div>\n        </div>\n        <div className=\"container-fluid content charts\" id=\"chart\">\n          <div className=\"row\">\n            <div className=\"col-md-9 col-sm-12\">\n              <iframe className=\"chartFrame\" srcDoc={this.state.chart}></iframe>\n              {this.state.loadingChart && (\n                <div className=\"loading\">\n                  <i className=\"fas fa-circle-notch fa-spin\"></i>\n                  Carregando dados...\n                </div>\n              )}\n            </div>\n            <div className=\"col-md-3 col-sm-12 mapa-info\">\n              <h2>Densidade demográfica</h2>\n              <p>\n                O gráfico ao lado traz uma correlação de densidade demográfica\n                com casos confirmados de covid-19.\n              </p>\n            </div>\n          </div>\n        </div>\n      </>\n    );\n  }\n}\n\nexport default GoogleApiWrapper({\n  apiKey: 'AIzaSyA4FiGeCZpUpO663wOfg-23qpr1-bLPZU4',\n})(MapContainer);\n"]},"metadata":{},"sourceType":"module"}